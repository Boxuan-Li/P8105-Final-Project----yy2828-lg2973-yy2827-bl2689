---
title: "Final Project"
author: "Boxuan Li"
date: "12/5/2017"
output: 
  html_document:
    code_folding: hide
---

```{r, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  fig.width = 8,
  fig.asp = .6,
  out.width = "90%"
)

library(tidyverse)
library(janitor)
library(ggthemes)
library(stringr)
library(tidytext)

theme_set(theme_bw())
theme_update(legend.position = "bottom")
```

## Read and Clean the Dataset
```{r Read and clean}
ted <- read_csv("./data/TED.csv") %>%
  clean_names() %>%
  mutate(no = row_number()) %>% 
  select(no, everything(),-event, -film_date, -num_speaker, -related_talks, -name)
```


### Tidy the *ratings* variable
```{r}
ratings = ted %>%
  select(no, ratings) %>% 
  mutate(ratings = substring(ratings,3, nchar(ratings)-2)) %>% 
  mutate(ratings = str_split(ratings,"\\}, \\{")) %>% 
  unnest(ratings) %>% 
  mutate(rat.words = sub(".*name': '(.*?)',.*", "\\1", ratings),
         rat.cnt = sub(".*'count': ", "", ratings))





```